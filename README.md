# Masterthesis #

This git repository contains two pipelines "Pipeline_insilico" and "Pipeline_realdata". Both are created to show the application of three well known boolean inference algorithms: REVEAL, BESTFIT and FULLFIT in combination with a k-means clustering algorithm (d= depth of clustering ; can be 1,2,3...or 10). Finally the inferred networks are scored against a goldstandard data set, either created itself (insilico_goldstandard) or provided by prior knowledge from other networks and literature based information (realdata_goldstandard).

The real-life time-course data is povided by a platform called DREAM-Challenge. The DREAM8 HPN-Breast Cancer Challenge was selected. Due to the fact that in real life experiments serveral cell lines are used and different stimuli and inhibtors, it is nessercary to filter the microarray data set into similar experinemtal conditions. Thus four cell lines in combination with 8 stimuli yield a data set of 32 contexts to be inferred and assessed. Here the SubChallenge 1A is considered, by inferring the edges of a network with its dependecies (without the edge confidence= edge weight).

The DreamChallenge provides a goldstandard data set by a testdataset for the participants of the challenge and after finishing the Challenge an aggregated network of the participants submissions. These aggregated networks are used (goldstandard_realdata) to assess the inferred networks. The scoring covers the true positves (tp), the true negatives (tn), the false positves (fp), the false negatives (fn), the accuracy (ACC), the precision (prec), the recall (rec), the balanced accuracy (BACC) and the Mathew-Correelation-Coefficient (MCC).

The insilico data set is generated by the create_bnet_data.py.(Still in process: it might be neccessary to search for a library of boolean rules, s.t. the resulting network is consistent and can't cause trouble with the following create_continous_data.py-file). With the insilico data set it can be shown wether the amount of measurements, or the number of nodes have a influence on the performanceof the algorithms and the runtime. And by the real-life data set the limitations of scalibility can be observed.

Requirements:

- Python 3.5.2 (default, Nov 23 2017, 16:37:01)
- Python 2.7.14 ; Anaconda, Inc. (default, Dec  7 2017, 17:05:42)
- R version 3.4.3 (2017-11-30)
- The real-life data set can be downloaded here: DREAM8 - HPN DREAM Breast Cancer Challenge (https://www.synapse.org/#!Synapse:syn5924123). Here the main not the full experimental data is used. The "main"- dataset has less nodes than the "full"-dataset. The Pipeline_realdata comes along with the DREAMCHAllenge  data within.
- Install PyBoolNet (https://github.com/hklarner/PyBoolNet/releases)

### WORKFLOW: for Pipeline_insilico data set ###

- Open a Terminal and go to the directory of the file

home/usr/Pipeline_insilico$ bash insilico.sh [# of max. nodes] [# of measurements] [binerization method] [inference method]

,where:
[# of max. nodes]: Is the number of nodes a generated network should maximally has. It starts by a minimum of 4 nodes. By typing 4, nothing happens, by typing 5: one network with 4 nodes is generated, by typing 6: two networks with 4 and 5 nodes are generated....and so on

[# of measurements]: It is recommanded to start by a value of 100 (this is in process). 

[binerization method]: K-means clustering algorithm: recommanded typing KM1, KM2 or KM3

[inference method]: type: BESTFIT, REVEAL or FULLFIT 

e.g.: home/usr/Pipeline_insilico$ bash insilico.sh 100 6 KM3 BESTFIT

The example above generates two networks with 100 measurements each and one with 4 nodes and the other with 5 nodes using the binarization method k-means clustering with a depth of 3 and the inference method BESTFIT.

All files are stored in the ./Pipeline_insilico/PyBoolNet/Backup/[# nodes][date][time]-folder with the scoing results (scoring_results.csv)

### WORKFLOW: for Pipeline_realdata data set ###


- Open a Terminal and go to the directory of the file

home/usr/Pipeline_realdata$ bash realdata.sh [binerization method] [inference method]

- Due to bad runtime of FULLFIT and especially REVEALit is recommanded to use BESTFIT on your local pc
- A network of 48 nodes with about 100 measurements needs approximatly 8minutes to run. Thus inferring all 32 networks may need 3 1/2 hours. 
- Keep this in mind, bevor starting the bash script...

- All files are stored in the ./Pipeline_realdata/PyBoolNet/Backup/[# nodes][date][time]-folder 
with the scoing results (scoring_results.csv)

## Quick Practice in PyBoolNet ##

- Run The PyBoolNet-Tool:
 
   e.g.:<br/> 
         $ cd \"directory of the converted file.bnet placed in the PyBoolNet-2.2.5 file\"<br/>
         $ python3<br/> 
       >>> from PyBoolNet import FileExchange<br/> 
       >>> from PyBoolNet import InteractionGraphs as IGs<br/> 
       >>> primes = FileExchange.bnet2primes(\"converted_Boolean2bnet_TS2B_output.bnet\")<br/> 
       >>> igraph = IGs.primes2igraph(primes)<br/> 
       >>> IGs.igraph2image(igraph, \"InteractionGraph.pdf\")<br/> 
       

